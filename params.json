{
  "name": "Coursera: R Programming, Homework 3 Question 3",
  "tagline": "",
  "body": "### Introduction\r\n\r\nThis data set is from the John Hopkins University Coursera Course titled: \"R Programming\". The current examples are pulled from **question 3** of **homework assignment 3**. You can find the text (verbatim) for the assignment below:\r\n\r\n_Write a function called rankhospital that takes three arguments: the 2-character abbreviated name of a_\r\n_state (state), an outcome (outcome), and the ranking of a hospital in that state for that outcome (num)._\r\n_The function reads the outcome-of-care-measures.csv \fand returns a character vector with the name_\r\n_of the hospital that has the ranking speci\fed by the num argument. For example, the call rankhospital(\"MD\", \"heart failure\", 5) would return a character vector containing the name of the hospital with the 5th lowest 30-day death rate for heart failure. The num argument can take values \"best\", \"worst\", or an integer indicating the ranking (smaller numbers are better). If the number given by num is larger than the number of hospitals in that state, then the function should return NA. Hospitals that do not have data on a particular outcome should be excluded from the set of hospitals when deciding the rankings._\r\n\r\n_Handling ties. It may occur that multiple hospitals have the same 30-day mortality rate for a given cause_\r\n_of death. In those cases ties should be broken by using the hospital name. For example, in Texas (\"TX\"),_\r\n_the hospitals with lowest 30-day mortality rate for heart failure are shown here._\r\n\r\n_The function should use the following template._\r\n\r\n    rankhospital <- function(state, outcome, num = \"best\") {\r\n    ## Read outcome data\r\n    ## Check that state and outcome are valid\r\n    ## Return hospital name in that state with the given rank\r\n    ## 30-day death rate\r\n    }\r\n\r\n_The function should check the validity of its arguments. If an invalid state value is passed to best, the_\r\n_function should throw an error via the stop function with the exact message \\invalid state\". If an invalid_\r\n_outcome value is passed to best, the function should throw an error via the stop function with the exact_\r\n_message \"invalid outcome\"._\r\n\r\n_Here is some sample output from the function._\r\n\r\n    > source(\"rankhospital.R\")\r\n    > rankhospital(\"TX\", \"heart failure\", 4)\r\n    [1] \"DETAR HOSPITAL NAVARRO\"\r\n    > rankhospital(\"MD\", \"heart attack\", \"worst\")\r\n    [1] \"HARFORD MEMORIAL HOSPITAL\"\r\n    > rankhospital(\"MN\", \"heart attack\", 5000)\r\n    [1] NA\r\n\r\n\r\n***\r\n\r\n\r\n\r\nThe data file can be found here: \r\n\r\n[Outcomes data](https://github.com/mjtat/Coursera-Programming-Assignment-Homework-3-Question-3/raw/master/outcome-of-care-measures.csv).\r\n\r\n**The script below will more or less do what the assignment asks.** Note, still working out the small detail about producing \"NA\" when `num` greater than the number of hospitals in a state. However, I don't it expect it to be extremely difficult with a little time spent debugging.\r\n\r\n\r\n\r\n***\r\n\r\n\r\n\r\n    ## Read in the data\r\n\r\n    outcome_dat <-\r\n        read.csv(\"outcome-of-care-measures.csv\",\r\n                 header = TRUE,\r\n                 stringsAsFactors = FALSE)\r\n\r\n    ## Select only the key variables from the original data.\r\n    outcome_dat_organized <-\r\n        data.frame(\r\n            as.character(outcome_dat$Hospital.Name),\r\n            as.character(outcome_dat$State),\r\n            outcome_dat$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack,\r\n            outcome_dat$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,\r\n            outcome_dat$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia,\r\n            stringsAsFactors = FALSE\r\n        )\r\n\r\n    # Rename the variables\r\n    names(outcome_dat_organized) <-\r\n        c(\"hospital\",\r\n          \"state\",\r\n          \"heart attack\",\r\n          \"heart failure\",\r\n          \"pneumonia\")\r\n\r\n\r\n    #Remove all the NA values.\r\n    outcome_dat_organized$`heart attack`[outcome_dat_organized$`heart attack` == \"Not Available\"] <-\r\n        NA\r\n    outcome_dat_organized$`heart failure`[outcome_dat_organized$`heart failure` == \"Not Available\"] <-\r\n        NA\r\n    outcome_dat_organized$pneumonia[outcome_dat_organized$pneumonia == \"Not Available\"] <-\r\n        NA\r\n\r\n    outcome_dat_organized <-\r\n        outcome_dat_organized[complete.cases(outcome_dat_organized), ]\r\n\r\n    ## Create the function \r\n    rank_hosp <- function(location, outcome, num) {\r\n        location <- toupper(location)\r\n        \r\n        outcome <- tolower(outcome)\r\n        \r\n        states <- outcome_dat_organized$state\r\n        \r\n        outcomes <- colnames(outcome_dat_organized)\r\n        \r\n        num_vector <- c(1:1000, \"best\", \"worst\")\r\n        \r\n        y <- match(location, states, nomatch = as.numeric(0))\r\n        \r\n        z <- match(outcome, outcomes, nomatch = as.numeric(0))\r\n        \r\n        w <- match(num, num_vector, nomatch = as.numeric(0))\r\n        \r\n        if (z == 0 && y == 0 && w == 0) {\r\n            print(\"Invalid State, Outcome, and Rank. Please enter valid values.\")\r\n            \r\n        } else if (z == 0 && y == 0) {\r\n            print(\"Invalid State and Outcome. Please enter valid values.\")\r\n            \r\n        } else if (z == 0) {\r\n            print(\"Invalid outcome. Please enter valid outcome.\")\r\n            \r\n        } else if (y == 0) {\r\n            print(\"Invalid state. Please enter valid state.\")\r\n            \r\n        } else if (w == 0) {\r\n            print(\"Invalid rank. Please enter a valid rank.\")\r\n            \r\n        } else {\r\n            state_subset <- subset(outcome_dat_organized,\r\n                                   location == state)\r\n            state_subset$`heart attack` <-\r\n                as.numeric(state_subset$`heart attack`)\r\n            \r\n            state_subset$`heart failure` <-\r\n                as.numeric(state_subset$`heart failure`)\r\n            \r\n            state_subset$pneumonia <-\r\n                as.numeric(state_subset$pneumonia)\r\n            \r\n            state_subset$rank_heartattack <-\r\n                rank(state_subset$`heart attack`,\r\n                     ties.method = \"min\")\r\n            \r\n            state_subset$rank_heartfailure <-\r\n                rank(state_subset$`heart failure`,\r\n                     ties.method = \"min\")\r\n            \r\n            state_subset$rank_pneumonia <-\r\n                rank(state_subset$pneumonia,\r\n                     ties.method = \"min\")\r\n            \r\n            if (outcome == \"heart attack\") {\r\n                x <- c(\"rank_heartattack\")\r\n                \r\n            } else if (outcome == \"heart failure\") {\r\n                x <- c(\"rank_heartfailure\")\r\n                \r\n            } else {\r\n                x <- c(\"rank_pneumonia\")\r\n                \r\n            }\r\n            \r\n            \r\n            rank_dat <-\r\n                with(state_subset, state_subset[order(state_subset[[x]],\r\n                                                      state_subset$hospital), ])\r\n            \r\n            \r\n            if (is.double(num) == TRUE)\r\n                print(rank_dat$hospital[num])\r\n            \r\n            if (num == \"worst\")\r\n                print(tail(rank_dat$hospital, n = 1))\r\n            \r\n            \r\n            if (num == \"best\")\r\n                print(head(rank_dat$hospital, n = 1))\r\n            \r\n            \r\n        }\r\n    }\r\n\r\n\r\n    ## Test the function a few times.\r\n\r\n    rank_hosp(\"TX\", \"heart failure\", 4)\r\n    rank_hosp(\"MD\", \"heart attack\", \"worst\")\r\n    rank_hosp(\"AA\", \"heart attack\", 5)\r\n    rank_hosp(\"AF\", \"cancer\", 5)\r\n    rank_hosp(\"DE\", \"pneumonia\", \"not the best\")\r\n    rank_hosp(\"OH\", \"pneumonia\", 10000)\r\n\r\n\r\n### Here's what the test output looks like currently.\r\n\r\n    > rank_hosp(\"TX\", \"heart failure\", 4)\r\n    [1] \"DETAR HOSPITAL NAVARRO\"\r\n    \r\n    > rank_hosp(\"MD\", \"heart attack\", \"worst\")\r\n    [1] \"HARFORD MEMORIAL HOSPITAL\"\r\n    \r\n    > rank_hosp(\"AA\", \"heart attack\", 5)\r\n    [1] \"Invalid state. Please enter valid state.\"\r\n    \r\n    > rank_hosp(\"AF\", \"cancer\", 5)\r\n    [1] \"Invalid State and Outcome. Please enter valid values.\"\r\n\r\n    > rank_hosp(\"DE\", \"pneumonia\", \"not the best\")\r\n    [1] \"Invalid rank. Please enter a valid rank.\"\r\n\r\n    > rank_hosp(\"OH\", \"pneumonia\", 10000)\r\n    [1] \"Invalid rank. Please enter a valid rank.\"\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}