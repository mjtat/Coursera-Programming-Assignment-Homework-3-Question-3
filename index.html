<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Coursera: R Programming, Homework 3 Question 3 : ">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Coursera: R Programming, Homework 3 Question 3</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/mjtat/Coursera-Programming-Assignment-Homework-3-Question-3">View on GitHub</a>

          <h1 id="project_title">Coursera: R Programming, Homework 3 Question 3</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/mjtat/Coursera-Programming-Assignment-Homework-3-Question-3/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/mjtat/Coursera-Programming-Assignment-Homework-3-Question-3/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h3>

<p>This data set is from the John Hopkins University Coursera Course titled: "R Programming". The current examples are pulled from <strong>question 3</strong> of <strong>homework assignment 3</strong>. You can find the text (verbatim) for the assignment below:</p>

<p><em>Write a function called rankhospital that takes three arguments: the 2-character abbreviated name of a</em>
<em>state (state), an outcome (outcome), and the ranking of a hospital in that state for that outcome (num).</em>
<em>The function reads the outcome-of-care-measures.csv and returns a character vector with the name</em>
<em>of the hospital that has the ranking specied by the num argument. For example, the call rankhospital("MD", "heart failure", 5) would return a character vector containing the name of the hospital with the 5th lowest 30-day death rate for heart failure. The num argument can take values "best", "worst", or an integer indicating the ranking (smaller numbers are better). If the number given by num is larger than the number of hospitals in that state, then the function should return NA. Hospitals that do not have data on a particular outcome should be excluded from the set of hospitals when deciding the rankings.</em></p>

<p><em>Handling ties. It may occur that multiple hospitals have the same 30-day mortality rate for a given cause</em>
<em>of death. In those cases ties should be broken by using the hospital name. For example, in Texas ("TX"),</em>
<em>the hospitals with lowest 30-day mortality rate for heart failure are shown here.</em></p>

<p><em>The function should use the following template.</em></p>

<pre><code>rankhospital &lt;- function(state, outcome, num = "best") {
## Read outcome data
## Check that state and outcome are valid
## Return hospital name in that state with the given rank
## 30-day death rate
}
</code></pre>

<p><em>The function should check the validity of its arguments. If an invalid state value is passed to best, the</em>
<em>function should throw an error via the stop function with the exact message "invalid state". If an invalid</em>
<em>outcome value is passed to best, the function should throw an error via the stop function with the exact</em>
<em>message "invalid outcome".</em></p>

<p><em>Here is some sample output from the function.</em></p>

<pre><code>&gt; source("rankhospital.R")
&gt; rankhospital("TX", "heart failure", 4)
[1] "DETAR HOSPITAL NAVARRO"
&gt; rankhospital("MD", "heart attack", "worst")
[1] "HARFORD MEMORIAL HOSPITAL"
&gt; rankhospital("MN", "heart attack", 5000)
[1] NA
</code></pre>

<hr>

<p>The data file can be found here: </p>

<p><a href="https://github.com/mjtat/Coursera-Programming-Assignment-Homework-3-Question-3/raw/master/outcome-of-care-measures.csv">Coursera R Programming Homework Assignment 3</a>.</p>

<p><strong>The script below will do what the assignment asks, with minor cosmetic differences.</strong> </p>

<p>The entire script can be found here: <a href="https://github.com/mjtat/Coursera-Programming-Assignment-Homework-3-Question-3/blob/master/rank_hosp_rev2.1.R">Rank_Hosp script</a></p>

<hr>

<h3>
<a id="first-read-in-the-data-organize-it-into-a-new-dataframe-then-rename-the-columns" class="anchor" href="#first-read-in-the-data-organize-it-into-a-new-dataframe-then-rename-the-columns" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>First read in the data, organize it into a new dataframe, then rename the columns.</h3>

<pre><code>## Read in the data

outcome_dat &lt;-
    read.csv("outcome-of-care-measures.csv",
             header = TRUE,
             stringsAsFactors = FALSE)

## Select only the key variables from the original data.
outcome_dat_organized &lt;-
    data.frame(
        as.character(outcome_dat$Hospital.Name),
        as.character(outcome_dat$State),
        outcome_dat$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack,
        outcome_dat$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,
        outcome_dat$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia,
        stringsAsFactors = FALSE
    )

# Rename the variables
names(outcome_dat_organized) &lt;-
    c("hospital",
      "state",
      "heart attack",
      "heart failure",
      "pneumonia")
</code></pre>

<h3>
<a id="remove-all-na-values" class="anchor" href="#remove-all-na-values" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Remove all NA values.</h3>

<pre><code>#Remove all the NA values.
outcome_dat_organized$`heart attack`[outcome_dat_organized$`heart attack` == "Not Available"] &lt;-
    NA
outcome_dat_organized$`heart failure`[outcome_dat_organized$`heart failure` == "Not Available"] &lt;-
    NA
outcome_dat_organized$pneumonia[outcome_dat_organized$pneumonia == "Not Available"] &lt;-
    NA

outcome_dat_organized &lt;-
    outcome_dat_organized[complete.cases(outcome_dat_organized), ]
</code></pre>

<h3>
<a id="create-the-rank_hosp-function" class="anchor" href="#create-the-rank_hosp-function" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create the <code>rank_hosp()</code> function.</h3>

<pre><code>###
rank_hosp &lt;- function(location, outcome, num) {
</code></pre>

<h3>
<a id="this-part-in-the-function-evaluates-the-number-of-hospitals-in-a-state-given-your-input-parameters" class="anchor" href="#this-part-in-the-function-evaluates-the-number-of-hospitals-in-a-state-given-your-input-parameters" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>This part in the function evaluates the number of hospitals in a state, given your input parameters.</h3>

<pre><code>    state_subset &lt;- subset(outcome_dat_organized, location == state)

    len &lt;- as.double(length(state_subset$hospital))
</code></pre>

<h3>
<a id="this-part-of-the-function-evaluates-if-you-entered-a-string-and-converts-the-string-to-lower-case" class="anchor" href="#this-part-of-the-function-evaluates-if-you-entered-a-string-and-converts-the-string-to-lower-case" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>This part of the function evaluates if you entered a string, and converts the string to lower case.</h3>

<pre><code>    if (is.character(num) == TRUE){
        num &lt;- tolower(num)

    } else {
        num &lt;- as.numeric(num)
    }
</code></pre>

<h3>
<a id="this-part-evaluates-if-you-entered-best-or-worst-as-a-value-it-assigns-a-number-1-or-the-value-of-the-last-row-in-the-resulting-data-frame" class="anchor" href="#this-part-evaluates-if-you-entered-best-or-worst-as-a-value-it-assigns-a-number-1-or-the-value-of-the-last-row-in-the-resulting-data-frame" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>This part evaluates if you entered <code>"best"</code> or <code>"worst"</code> as a value. It assigns a number (1, or the value of the last row in the resulting data frame)</h3>

<pre><code>    if (num == "best") {
        num &lt;- 1

    } else if (num == "worst") {
        num &lt;- len 
    }
</code></pre>

<h3>
<a id="the-next-few-parts-creates-lists-of-states-outcomes-and-numbers-it-then-conducts-a-boolean-operation-to-evaluate-if-the-values-you-entered-are-valid-if-true-sets-the-variable-to-1-if-false-sets-the-variable-to-0" class="anchor" href="#the-next-few-parts-creates-lists-of-states-outcomes-and-numbers-it-then-conducts-a-boolean-operation-to-evaluate-if-the-values-you-entered-are-valid-if-true-sets-the-variable-to-1-if-false-sets-the-variable-to-0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The next few parts creates lists of states, outcomes, and numbers. It then conducts a boolean operation to evaluate if the values you entered are valid. If <code>TRUE</code>, sets the variable to 1. If <code>FALSE</code>, sets the variable to 0.</h3>

<pre><code>    location &lt;- toupper(location)
    outcome &lt;- tolower(outcome)
    state_list &lt;- unique(outcome_dat_organized$state)
    outcome_list &lt;- colnames(outcome_dat_organized)
    num_list &lt;- c(1:9999)

    x &lt;- (as.numeric(location %in% state_list))
    y &lt;- (as.numeric(outcome %in% outcome_list))
    z &lt;- (as.numeric(num %in% num_list))
</code></pre>

<h3>
<a id="the-next-section-does-several-if-loops-to-determine-if-there-are-mismatching-inputs-of-any-sort-and-will-stop-the-function-if-the-user-provides-an-invalid-input" class="anchor" href="#the-next-section-does-several-if-loops-to-determine-if-there-are-mismatching-inputs-of-any-sort-and-will-stop-the-function-if-the-user-provides-an-invalid-input" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The next section does several if loops to determine if there are mismatching inputs of any sort, and will stop the function if the user provides an invalid input.</h3>

<pre><code>    if (x == 0 &amp;&amp; y == 0 &amp;&amp; z == 0) {
        stop("Invalid state, outcome, and number. Please enter valid values.")
    } else if (x == 0 &amp;&amp; y == 0) {
        stop("Invalid state and outcome. Please enter valid values.")
    } else if (x == 0) {
        stop("Invalid state. Please enter a valid value")
    } else if (y == 0) {
        stop("Invalid outcome. Please enter a valid outcome.")
    } else if (is.character(num) == TRUE)  {
            if(num != "worst" || num != "best") {
                stop("The number you entered is invalid. Please enter a valid number.") 
            }
    } else if (num &gt; len) {
        stop("The number you entered is greater than the number of hospitals in that state. Enter a lower number.")
            } else if (z == 0) {
        stop("Invalid number. Please enter a valid number.")
    } else {
</code></pre>

<h3>
<a id="the-next-part-creates-columns-that-rank-each-outcome-it-then-uses-if-loops-to-rename-them" class="anchor" href="#the-next-part-creates-columns-that-rank-each-outcome-it-then-uses-if-loops-to-rename-them" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The next part creates columns that rank each outcome. It then uses if loops to rename them.</h3>

<pre><code>        state_subset$`heart attack` &lt;-
            as.numeric(state_subset$`heart attack`)

        state_subset$`heart failure` &lt;-
            as.numeric(state_subset$`heart failure`)

        state_subset$pneumonia &lt;-
            as.numeric(state_subset$pneumonia)

        state_subset$rank_heartattack &lt;-
            rank(state_subset$`heart attack`,
                 ties.method = "min")

        state_subset$rank_heartfailure &lt;-
            rank(state_subset$`heart failure`,
                 ties.method = "min")

        state_subset$rank_pneumonia &lt;-
            rank(state_subset$pneumonia,
                 ties.method = "min")

        if (outcome == "heart attack") {
            column_name &lt;- c("rank_heartattack")

        } else if (outcome == "heart failure") {
            column_name &lt;- c("rank_heartfailure")

        } else { 
            column_name &lt;- c("rank_pneumonia")
        }
</code></pre>

<h3>
<a id="create-one-more-data-frame-then-searches-for-the-cell-number-that-the-user-input" class="anchor" href="#create-one-more-data-frame-then-searches-for-the-cell-number-that-the-user-input" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create one more data frame, then searches for the cell number that the user input.</h3>

<pre><code>        rank_dat &lt;-
            with(state_subset, state_subset[order(state_subset[[column_name]],
                                                  state_subset$hospital), ])

        if (is.numeric(num) == TRUE)
            print(rank_dat$hospital[num])

    }

}

## Test it a few times.

rank_hosp("TX", "heart failure", 4)
rank_hosp("MD", "heart attack", "worst")
rank_hosp("MN", "heart attack", 5000)
rank_hosp("AL", "heart attack", 5)
rank_hosp("AF", "cancer", 5)
rank_hosp("DE", "pneumonia", "best")
rank_hosp("OH", "pneumonia", "not always the best")
</code></pre>

<h3>
<a id="heres-what-the-test-output-looks-like-currently" class="anchor" href="#heres-what-the-test-output-looks-like-currently" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Here's what the test output looks like currently.</h3>

<pre><code>&gt; rank_hosp("TX", "heart failure", 4)
[1] "DETAR HOSPITAL NAVARRO"

&gt; rank_hosp("MD", "heart attack", "worst")
[1] "HARFORD MEMORIAL HOSPITAL"

&gt; rank_hosp("MN", "heart attack", 5000)
  Error in rank_hosp("MN", "heart attack", 5000) : 
    The number you entered is greater than the number of hospitals in that state. Enter a lower number.

&gt; rank_hosp("AL", "heart attack", 5)
[1] "PRATTVILLE BAPTIST HOSPITAL"
&gt; rank_hosp("AF", "cancer", 5)
 Error in rank_hosp("AF", "cancer", 5) : 
   Invalid state and outcome. Please enter valid values.

&gt; rank_hosp("DE", "pneumonia", "best")
[1] "BEEBE MEDICAL CENTER"

&gt; rank_hosp("OH", "pneumonia", "not always the best")
Error in rank_hosp("OH", "pneumonia", "not always the best") : 
  The number you entered is invalid. Please enter a valid number.
</code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Coursera: R Programming, Homework 3 Question 3 maintained by <a href="https://github.com/mjtat">mjtat</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
